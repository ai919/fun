# Custom æ¨¡å¼ç­–ç•¥å¿«é€Ÿå‚è€ƒ

## ğŸ¯ æ–°å¢ç­–ç•¥ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

### 1. æŠ•ç¥¨/è®¡æ•°æ¨¡å¼ (`vote`)

**é€‚ç”¨åœºæ™¯**: æ€§æ ¼ç±»å‹æµ‹è¯•ã€åå¥½é€‰æ‹©ã€åˆ†ç±»æµ‹è¯•

**é…ç½®ç¤ºä¾‹**:
```json
{
  "scoring_mode": "custom",
  "scoring_config": {
    "strategy": "vote",
    "vote_threshold": 3,
    "tie_breaker": "first"
  }
}
```

**é…ç½®è¯´æ˜**:
- `vote_threshold` (å¯é€‰): æœ€å°‘æŠ•ç¥¨æ•°ï¼Œé»˜è®¤ 0
- `tie_breaker` (å¯é€‰): å¹³å±€å¤„ç†æ–¹å¼
  - `first`: é€‰æ‹©ç¬¬ä¸€ä¸ªï¼ˆé»˜è®¤ï¼‰
  - `random`: éšæœºé€‰æ‹©
  - `all`: è¿”å›æ‰€æœ‰ï¼ˆå½“å‰åªè¿”å›ç¬¬ä¸€ä¸ªï¼‰

**ä½¿ç”¨è¦æ±‚**:
- å¿…é¡»åœ¨ `question_options` è¡¨ä¸­è®¾ç½® `map_result_code` å­—æ®µ
- æ¯ä¸ªé€‰é¡¹çš„ `map_result_code` åº”è¯¥å¯¹åº” `results` è¡¨ä¸­çš„ `code` å­—æ®µ

**å·¥ä½œåŸç†**:
1. ç»Ÿè®¡æ¯ä¸ª `map_result_code` è¢«é€‰ä¸­çš„æ¬¡æ•°
2. é€‰æ‹©å¾—ç¥¨æœ€å¤šçš„ç»“æœä»£ç 
3. å¦‚æœé…ç½®äº† `vote_threshold`ï¼Œåªè€ƒè™‘è¾¾åˆ°é˜ˆå€¼çš„æŠ•ç¥¨

---

### 2. åŠ æƒç´¯åŠ æ¨¡å¼ (`weighted_sum`)

**é€‚ç”¨åœºæ™¯**: é‡è¦æ€§ä¸åŒçš„é¢˜ç›®ã€èƒ½åŠ›æµ‹è¯•ã€è¯„ä¼°æµ‹è¯•

**é…ç½®ç¤ºä¾‹**:
```json
{
  "scoring_mode": "custom",
  "scoring_config": {
    "strategy": "weighted_sum",
    "question_weights": {
      "1": 1.0,
      "2": 2.0,
      "3": 0.5,
      "4": 1.5
    }
  }
}
```

**é…ç½®è¯´æ˜**:
- `question_weights`: é¢˜ç›®æ ‡è¯†ï¼ˆ`question_id`ï¼‰åˆ°æƒé‡çš„æ˜ å°„
- æƒé‡å¯ä»¥æ˜¯ä»»æ„æ­£æ•°ï¼ˆæ”¯æŒå°æ•°ï¼‰
- æœªé…ç½®çš„é¢˜ç›®é»˜è®¤æƒé‡ä¸º 1.0

**è®¡ç®—å…¬å¼**:
```
æœ€ç»ˆåˆ†æ•° = Î£(é€‰é¡¹åˆ†æ•° Ã— é¢˜ç›®æƒé‡)
```

**ç¤ºä¾‹**:
- é¢˜ç›®1ï¼ˆæƒé‡1.0ï¼‰: é€‰é¡¹Aå¾—åˆ†5 â†’ è´¡çŒ® 5 Ã— 1.0 = 5åˆ†
- é¢˜ç›®2ï¼ˆæƒé‡2.0ï¼‰: é€‰é¡¹Bå¾—åˆ†3 â†’ è´¡çŒ® 3 Ã— 2.0 = 6åˆ†
- é¢˜ç›®3ï¼ˆæƒé‡0.5ï¼‰: é€‰é¡¹Cå¾—åˆ†4 â†’ è´¡çŒ® 4 Ã— 0.5 = 2åˆ†
- **æ€»åˆ†**: 5 + 6 + 2 = 13åˆ†

---

### 3. ç™¾åˆ†æ¯”é˜ˆå€¼æ¨¡å¼ (`percentage_threshold`)

**é€‚ç”¨åœºæ™¯**: éœ€è¦"å¹³è¡¡å‹"ç»“æœçš„æµ‹è¯•ã€å¤šç»´åº¦æ€§æ ¼æµ‹è¯•ã€èƒ½åŠ›è¯„ä¼°

**é…ç½®ç¤ºä¾‹**:
```json
{
  "scoring_mode": "custom",
  "scoring_config": {
    "strategy": "percentage_threshold",
    "dimensions": ["A", "B", "C", "D"],
    "weights": {
      "1": {"A": {"A": 1}, "B": {"B": 1}, "C": {"C": 1}, "D": {"D": 1}},
      "2": {"A": {"A": 2}, "B": {"B": 2}}
    },
    "thresholds": {
      "BALANCED": {
        "all_dimensions": {
          "A": {"min": 20, "max": 30},
          "B": {"min": 20, "max": 30},
          "C": {"min": 20, "max": 30},
          "D": {"min": 20, "max": 30}
        }
      },
      "DOMINANT_A": {
        "dimension": "A",
        "min": 60
      },
      "DOMINANT_B": {
        "dimension": "B",
        "min": 60
      },
      "MIXED": {
        "all_dimensions": {
          "A": {"min": 15, "max": 35},
          "B": {"min": 15, "max": 35}
        }
      }
    },
    "default_result_code": "MIXED"
  }
}
```

**é…ç½®è¯´æ˜**:

1. **åŸºç¡€é…ç½®** (ä¸ dimensions æ¨¡å¼ç›¸åŒ):
   - `dimensions`: ç»´åº¦åˆ—è¡¨
   - `weights`: æƒé‡é…ç½®

2. **é˜ˆå€¼é…ç½®** (`thresholds`):
   - é”®: ç»“æœä»£ç ï¼ˆå¯¹åº” `results.code`ï¼‰
   - å€¼: é˜ˆå€¼è§„åˆ™

3. **é˜ˆå€¼è§„åˆ™ç±»å‹**:

   **a) å•ä¸ªç»´åº¦é˜ˆå€¼**:
   ```json
   {
     "dimension": "A",
     "min": 60,        // A ç»´åº¦ç™¾åˆ†æ¯” >= 60%
     "max": 80         // A ç»´åº¦ç™¾åˆ†æ¯” <= 80%
   }
   ```

   **b) æ‰€æœ‰ç»´åº¦é˜ˆå€¼** (ç”¨äº"å¹³è¡¡å‹"):
   ```json
   {
     "all_dimensions": {
       "A": {"min": 20, "max": 30},
       "B": {"min": 20, "max": 30}
     }
   }
   ```

   **c) é€šç”¨é˜ˆå€¼** (æ‰€æœ‰ç»´åº¦éƒ½åœ¨èŒƒå›´å†…):
   ```json
   {
     "min": 20,
     "max": 30
   }
   ```

4. **é»˜è®¤ç»“æœ** (`default_result_code`):
   - å¦‚æœæ²¡æœ‰åŒ¹é…çš„é˜ˆå€¼ï¼Œä½¿ç”¨æ­¤ç»“æœä»£ç 
   - å¦‚æœæœªé…ç½®ï¼Œå›é€€åˆ°æœ€é«˜ç™¾åˆ†æ¯”ç»´åº¦

**åŒ¹é…é€»è¾‘**:
1. è®¡ç®—å„ç»´åº¦å¾—åˆ†ç™¾åˆ†æ¯”
2. æŒ‰é¡ºåºæ£€æŸ¥æ¯ä¸ªé˜ˆå€¼è§„åˆ™
3. ç¬¬ä¸€ä¸ªåŒ¹é…çš„è§„åˆ™å¯¹åº”çš„ç»“æœä»£ç å³ä¸ºæœ€ç»ˆç»“æœ
4. å¦‚æœæ²¡æœ‰åŒ¹é…ï¼Œä½¿ç”¨ `default_result_code` æˆ–æœ€é«˜ç™¾åˆ†æ¯”ç»´åº¦

**ç¤ºä¾‹åœºæ™¯**:
- **å¹³è¡¡å‹**: æ‰€æœ‰ç»´åº¦éƒ½åœ¨ 20%-30% ä¹‹é—´ â†’ `BALANCED`
- **ä¸»å¯¼å‹A**: A ç»´åº¦ >= 60% â†’ `DOMINANT_A`
- **æ··åˆå‹**: æ‰€æœ‰ç»´åº¦éƒ½åœ¨ 15%-35% ä¹‹é—´ â†’ `MIXED`

---

## ğŸ“Š ç­–ç•¥å¯¹æ¯”

| ç­–ç•¥ | å¤æ‚åº¦ | é€‚ç”¨åœºæ™¯ | é…ç½®éš¾åº¦ |
|------|--------|----------|----------|
| `vote` | â­ | ç®€å•æŠ•ç¥¨æµ‹è¯• | â­ ç®€å• |
| `weighted_sum` | â­â­ | é‡è¦æ€§ä¸åŒçš„é¢˜ç›® | â­â­ ä¸­ç­‰ |
| `percentage_threshold` | â­â­â­ | å¤æ‚å¤šç»´åº¦åˆ†æ | â­â­â­ è¾ƒéš¾ |

---

## ğŸ” è°ƒè¯•æŠ€å·§

### æŠ•ç¥¨æ¨¡å¼
- æ£€æŸ¥ `question_options.map_result_code` æ˜¯å¦æ­£ç¡®è®¾ç½®
- æ£€æŸ¥ `results.code` æ˜¯å¦ä¸ `map_result_code` åŒ¹é…
- æŸ¥çœ‹ `dimension_scores` è¿”å›çš„æŠ•ç¥¨ç»Ÿè®¡

### åŠ æƒç´¯åŠ æ¨¡å¼
- æ£€æŸ¥ `question_weights` ä¸­çš„ `question_id` æ˜¯å¦æ­£ç¡®
- éªŒè¯æƒé‡å€¼æ˜¯å¦åˆç†ï¼ˆå»ºè®®åœ¨ 0.1 - 5.0 ä¹‹é—´ï¼‰
- æŸ¥çœ‹ `total_score` æ˜¯å¦ç¬¦åˆé¢„æœŸ

### ç™¾åˆ†æ¯”é˜ˆå€¼æ¨¡å¼
- å…ˆä½¿ç”¨ `percentage` ç­–ç•¥æŸ¥çœ‹å„ç»´åº¦ç™¾åˆ†æ¯”
- æ ¹æ®å®é™…ç™¾åˆ†æ¯”è°ƒæ•´é˜ˆå€¼èŒƒå›´
- ä½¿ç”¨ `default_result_code` ä½œä¸ºå…œåº•

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **æŠ•ç¥¨æ¨¡å¼**:
   - ç¡®ä¿æ¯ä¸ªé€‰é¡¹éƒ½æœ‰ `map_result_code`
   - è®¾ç½®åˆç†çš„ `vote_threshold` é¿å…å¶ç„¶ç»“æœ
   - è€ƒè™‘ä½¿ç”¨ `tie_breaker: "random"` å¢åŠ è¶£å‘³æ€§

2. **åŠ æƒç´¯åŠ æ¨¡å¼**:
   - æ ¸å¿ƒé¢˜ç›®æƒé‡è®¾ä¸º 2.0-3.0
   - æ¬¡è¦é¢˜ç›®æƒé‡è®¾ä¸º 0.5-1.0
   - é¿å…æƒé‡å·®å¼‚è¿‡å¤§ï¼ˆå¦‚ 10:1ï¼‰

3. **ç™¾åˆ†æ¯”é˜ˆå€¼æ¨¡å¼**:
   - å…ˆè®¾è®¡ç»´åº¦æƒé‡ï¼Œå†è®¾è®¡é˜ˆå€¼
   - é˜ˆå€¼èŒƒå›´è¦æœ‰é‡å ï¼Œé¿å…"æ— åŒ¹é…"æƒ…å†µ
   - ä½¿ç”¨ `default_result_code` ä½œä¸ºå®‰å…¨ç½‘
   - æµ‹è¯•è¾¹ç•Œæƒ…å†µï¼ˆå¦‚æ‰€æœ‰ç»´åº¦éƒ½ç›¸åŒï¼‰

---

## ğŸ“ å®Œæ•´ç¤ºä¾‹

### ç¤ºä¾‹ 1: åŠ¨ç‰©æ€§æ ¼æµ‹è¯•ï¼ˆæŠ•ç¥¨æ¨¡å¼ï¼‰

```json
{
  "scoring_mode": "custom",
  "scoring_config": {
    "strategy": "vote",
    "vote_threshold": 2,
    "tie_breaker": "first"
  }
}
```

**é¢˜ç›®é€‰é¡¹é…ç½®**:
- é¢˜ç›®1é€‰é¡¹A: `map_result_code = "CAT"`
- é¢˜ç›®1é€‰é¡¹B: `map_result_code = "DOG"`
- é¢˜ç›®2é€‰é¡¹A: `map_result_code = "CAT"`
- é¢˜ç›®2é€‰é¡¹B: `map_result_code = "FOX"`

**ç»“æœ**: å¦‚æœç”¨æˆ·é€‰æ‹© 1A å’Œ 2Aï¼Œåˆ™ CAT å¾—2ç¥¨ï¼Œé€‰æ‹© CAT ç»“æœã€‚

---

### ç¤ºä¾‹ 2: èƒ½åŠ›è¯„ä¼°ï¼ˆåŠ æƒç´¯åŠ æ¨¡å¼ï¼‰

```json
{
  "scoring_mode": "custom",
  "scoring_config": {
    "strategy": "weighted_sum",
    "question_weights": {
      "10": 3.0,  // æ ¸å¿ƒèƒ½åŠ›é¢˜
      "11": 3.0,
      "12": 2.0,  // é‡è¦èƒ½åŠ›é¢˜
      "13": 2.0,
      "14": 1.0,  // ä¸€èˆ¬èƒ½åŠ›é¢˜
      "15": 1.0
    }
  }
}
```

---

### ç¤ºä¾‹ 3: å¤§äº”äººæ ¼æµ‹è¯•ï¼ˆç™¾åˆ†æ¯”é˜ˆå€¼æ¨¡å¼ï¼‰

```json
{
  "scoring_mode": "custom",
  "scoring_config": {
    "strategy": "percentage_threshold",
    "dimensions": ["O", "C", "E", "A", "N"],
    "weights": {
      "1": {"A": {"O": 1}, "B": {"C": 1}, "C": {"E": 1}}
    },
    "thresholds": {
      "BALANCED": {
        "all_dimensions": {
          "O": {"min": 15, "max": 25},
          "C": {"min": 15, "max": 25},
          "E": {"min": 15, "max": 25},
          "A": {"min": 15, "max": 25},
          "N": {"min": 15, "max": 25}
        }
      },
      "HIGH_OPENNESS": {
        "dimension": "O",
        "min": 30
      }
    },
    "default_result_code": "MIXED"
  }
}
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

- æŸ¥çœ‹ [è¯„åˆ†æ¨¡å¼è¯¦ç»†è¯´æ˜](./SCORING_MODES.md) äº†è§£æ‰€æœ‰ç­–ç•¥
- æŸ¥çœ‹ [å¯èƒ½çš„è¯„åˆ†æ¨¡å¼æ‰©å±•](./POSSIBLE_SCORING_MODES.md) æ¢ç´¢æ›´å¤šå¯èƒ½æ€§
- ä½¿ç”¨ [é…ç½®è¯Šæ–­å·¥å…·](../check_tests_config.php) éªŒè¯é…ç½®

